<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>RedGrey的博客 - 愿你我都有美好生活</title><meta name="author" content="RedGrey"><meta name="copyright" content="RedGrey"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="RedGrey的博客">
<meta property="og:url" content="http://redgrey93.com/index.html">
<meta property="og:site_name" content="RedGrey的博客">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://redgrey93.com/img/redgrey.jpg">
<meta property="article:author" content="RedGrey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://redgrey93.com/img/redgrey.jpg"><link rel="shortcut icon" href="/img/redgrey.jpg"><link rel="canonical" href="http://redgrey93.com/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'RedGrey的博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-03-28 21:41:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3551570681028814" crossorigin="anonymous"></script><meta name="baidu-site-verification" content="codeva-WVy8t6tRPe" /><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/redgrey.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr class="custom-hr"/></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="RedGrey的博客"><span class="site-name">RedGrey的博客</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">RedGrey的博客</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20240324/cf463d12f/" title="(*2700) ICM Technex 2018 and Codeforces Round 463 (Div. 1 + Div. 2, combined) F. Escape Through Leaf">(*2700) ICM Technex 2018 and Codeforces Round 463 (Div. 1 + Div. 2, combined) F. Escape Through Leaf</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-03-24T05:57:38.000Z" title="Created 2024-03-24 13:57:38">2024-03-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
原题链接：https://codeforces.com/contest/932/problem/F
F. Escape Through Leaf
题目描述
有一颗n(2≤n≤105)n(2\le n \le 10^5)n(2≤n≤105)个节点的树，根节点为111，每个节点上都有两个值与它关联，记第iii个节点上的两个值分别为ai,bi(−105≤ai,bi≤105)a_i,b_i(-10^5\le a_i,b_i\le10^5)ai​,bi​(−105≤ai​,bi​≤105)，你可以从某个节点跳到以它为根的子树的任意节点上，从xxx节点跳到yyy节点的代价为ax∗bya_x*b_yax​∗by​，对于每个节点，计算跳转到任何一个叶子节点最小的代价；注意：1.根节点不可能是叶子节点；2.叶子几点本身的代价为000
输入格式
第1行：nnn
第2行，空格分隔：a1 a2 ... ana_1\ a_2\ ...\ a_na1​ a2​ ... an​
第3行,空格分隔：b1 b2 ... bnb_1\ b_2\ ...\ b_nb1​ b2​ ... bn​
接下来共n−1n-1n−1 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20240312/codeforces-round185-div1-b/" title="(*2400) Codeforces Round 185 (Div. 1) B. Cats Transport">(*2400) Codeforces Round 185 (Div. 1) B. Cats Transport</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-03-12T14:42:15.000Z" title="Created 2024-03-12 22:42:15">2024-03-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
原题链接：https://codeforces.com/contest/311/problem/B
B. Cats Transport
题目描述
沿路有n(2≤n≤105)n(2\le n\le 10^5)n(2≤n≤105)座土堆，第i−1i-1i−1和第iii座土堆之间的距离为di(1≤di&lt;104)d_i(1\le d_i \lt 10^4)di​(1≤di​&lt;104)米，有m(1≤m≤105)m(1\le m\le 10^5)m(1≤m≤105)只猫，第jjj只猫在tj(0≤tj≤109)t_j(0\le t_j\le 10^9)tj​(0≤tj​≤109)时刻走到土堆hj(1≤hj≤n)h_j(1\le h_j\le n)hj​(1≤hj​≤n)上，然后在该土堆上等待，饲养员从第一个土堆出发，速度为111米/单位时间，按顺序从111到nnn走过所有土堆，如果ttt时刻到了第jjj座土堆，猫已经在这座土堆上了，则将这只猫带走，猫的等待时间为t−tjt-t_jt−tj​，共有p(1≤p≤100)p(1\le p \le 100)p(1≤p≤100)个饲养员，求将所有 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20240226/codeforces-round660-div2-e/" title="(*2700) Codeforces Round 660 (Div. 2) E. Uncle Bogdan and Projections">(*2700) Codeforces Round 660 (Div. 2) E. Uncle Bogdan and Projections</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-02-26T13:26:49.000Z" title="Created 2024-02-26 21:26:49">2024-02-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
原题链接：https://codeforces.com/contest/1388/problem/E
E. Uncle Bogdan and Projections
After returning to shore, uncle Bogdan usually visits the computer club “The Rock”, to solve tasks in a pleasant company. One day, uncle Bogdan met his good old friend who told him one unusual task…
There are nnn non-intersecting horizontal segments with ends in integers points on the plane with the standard cartesian coordinate system. All segments are strictly above the OXOXOX axis. You can choose an arbitrary  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20240129/greatest-common-divisor/" title="最大公约数/扩展欧几里得算法">最大公约数/扩展欧几里得算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-01-29T14:35:14.000Z" title="Created 2024-01-29 22:35:14">2024-01-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E5%AD%A6-Math/">数学/Math</a></span></div><div class="content">
求解最大公约数
问题：求两个数a,ba,ba,b的最大公约数。
我们把a,ba,ba,b的最大公约数记为gcd(a,b)gcd(a,b)gcd(a,b)。
朴素算法
朴素的算法是，求出a,ba,ba,b的素因子分解，取两个数共同的素因子，即为最大公约数：
a=p1a1p2a2...pnana=p_1^{a_1}p_2^{a_2}...p_n^{a_n}
a=p1a1​​p2a2​​...pnan​​
b=p1b1p2b2...pnbnb=p_1^{b_1}p_2^{b_2}...p_n^{b_n}
b=p1b1​​p2b2​​...pnbn​​
gcd(a,b)=p1min(a1,b1)p2min(a2,b2)...pnmin(an,bn)gcd(a,b)=p_1^{min(a_1,b_1)}p_2^{min(a_2,b_2)}...p_n^{min(a_n,b_n)}
gcd(a,b)=p1min(a1​,b1​)​p2min(a2​,b2​)​...pnmin(an​,bn​)​
a1,a2,...,an,b1,b2,...,bn≥0a_1,a_2,...,a_n,b_1,b_2 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231219/mod-inverse/" title="模逆元">模逆元</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-12-18T16:54:26.000Z" title="Created 2023-12-19 00:54:26">2023-12-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E5%AD%A6-Math/">数学/Math</a></span></div><div class="content">
问题描述
如果a∗b≡1(modn)a*b \equiv 1 \pmod na∗b≡1(modn)，≡\equiv≡符号表示a∗b%n=1a*b \% n=1a∗b%n=1，%\%%表示模运算，模运算就是取余，x%y=x−⌊xy⌋∗yx\%y=x-\lfloor\frac{x}{y}\rfloor*yx%y=x−⌊yx​⌋∗y，例如5%3=25\%3=25%3=2
则a,ba,ba,b在模nnn情况下互为模逆元，模逆元可以记为a−1a^{-1}a−1，即a−1≡b(modn),b−1≡a(modn)a^{-1} \equiv b \pmod n,b^{-1} \equiv a \pmod na−1≡b(modn),b−1≡a(modn)
aaa在模nnn的情况下，存在模逆元的充要条件是gcd(a,n)=1gcd(a,n)=1gcd(a,n)=1，gcd(a,n)gcd(a,n)gcd(a,n)表示aaa和nnn的最大公约数，即aaa与nnn互素。
简单描述一下，非正式的证明：


必要条件证明：如果aaa与nnn不互素，设gcd(a,n)=d&gt;1gcd(a,n)=d \gt 1 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231127/IOI07-training/" title="(Very Hard) IOI 2007 Day 2 Problem 3 - Training">(Very Hard) IOI 2007 Day 2 Problem 3 - Training</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-27T13:57:18.000Z" title="Created 2023-11-27 21:57:18">2023-11-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
IOI 2007 TRAINING
原题链接：https://oj.uz/problem/view/IOI07_training
官方题解：https://ioinformatics.org/files/ioi2007solutions.pdf
题目描述
有NNN个节点，MMM条边，其中N−1N-1N−1条边是“树边”，NNN个节点和这N−1N-1N−1条边能够组成一颗所有节点都连通的树，其它的边都是“非树边”，每一条“非树边eee”都有一个相应的费用w(e)w(e)w(e)，这些“非树边”是可以删除的，删除边需要付出对应的费用；现在的任务目标是：删除某些“非树边”，使得剩下的图中，不存在边的数量为偶数的环，并且删除“非树边”所付出的费用和最小，求这个最小费用。
解决方案
参考：https://ioinformatics.org/files/ioi2007solutions.pdf
题目要我们求删除一些“非树边”使得不存在边数为偶数的环时删除的边的最小费用，我们把边数为偶数的环称为“偶环”。我们可以逆向思维思考：从一棵树开始，我们需要寻找一个总费用最大的“非树边”集合，将这些“非树边 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231114/cyclic-longest-common-subsequence/" title="循环最长公共子序列/Cyclic Longest Common Subsequence">循环最长公共子序列/Cyclic Longest Common Subsequence</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-14T13:44:00.000Z" title="Created 2023-11-14 21:44:00">2023-11-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
循环最长公共子序列
参考：https://arxiv.org/pdf/1208.0396.pdf
问题描述
我们需要求两个循环序列的最长公共子序列，对于循环序列来说，把任意一个元素作为起始元素都认为是同一个序列，例如，循环序列’algorithm’同时也可以写作’rithmalgo’或者’thmalgori’，对于正常的序列’algorithm’和’grammar’来说，最长公共子序列为’grm’，但是对于循环序列来说，它们的最长公共子序列是’grma’
预备知识
对于普通的非循环序列的最长公共子序列来说，记两个序列分别为A,BA,BA,B，AAA的元素个数为mmm，BBB的元素个数为nnn，例如AAA为BBAABBAABBAA，BBB为ABABBABABBABABB，可以将其转化为有向图，每个单元格可以看作图中的一个节点，向右或者向下可以连一条边，对于单元格(i,j)(i,j)(i,j)来说，如果A[i]A[i]A[i]和B[j]B[j]B[j]的元素相同，则从(i−1,j−1)(i-1,j-1)(i−1,j−1)向(i,j)(i,j)(i,j)斜着连一条边，如下图所示，记该有向图 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231107/convex-hull-trick/" title="凸包技巧/Convex Hull Trick">凸包技巧/Convex Hull Trick</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-07T15:07:46.000Z" title="Created 2023-11-07 23:07:46">2023-11-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
凸包技巧
参考：https://codeforces.com/blog/entry/63823
问题描述
我们想要快速地计算对于某个固定的xxx，下述算式集合中的最大值：
maxj∈S(kj∗x+bj)max_{j \in S}(k_j*x+b_j)
maxj∈S​(kj​∗x+bj​)
此外，插入一个新的jjj对应的算式到集合中也应该需要高效地完成。
思路
注意算式kj∗x+bjk_j*x+b_jkj​∗x+bj​的形式，它相当于斜率为kjk_jkj​，与yyy轴交点为kjk_jkj​的直线，所以这个问题就相当于是给定一系列直线与一个特定的xxx值，求在横坐标为xxx时，这一系列直线中最大的yyy值；如果将所有的直线画出来，你会发现最大值将是一个凸包的边缘，如下图所示：

一些观察到的结论

在凸包上的每一条线都在一段连续的xxx值区间内是最大值，相反，不在凸包上的线是无用的，这些线永远不会是最大值
在凸包上所有线的斜率都不一样，斜率的顺序同时决定了他们在凸包上的位置。斜率值较小的线在凸包上位于斜率比它大的线的左侧
因此，一个可行的策略是只维护凸包上的线，而不保存那些无用的线

一 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231025/set-enumerate-by-binary/" title="集合的二进制表示法">集合的二进制表示法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-10-25T13:31:30.000Z" title="Created 2023-10-25 21:31:30">2023-10-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
集合的二进制表示法
概述
有一个包含nnn个不同元素的集合，假设为：{1,2,3,..,n}\{1,2,3,..,n\}{1,2,3,..,n}，他的子集个数有2n2^n2n个，当nnn的大小不是特别大的时候，例如n≤30n\le 30n≤30时（约等于107374182410737418241073741824），我们则可以在合理的时间内枚举出它的所有子集。
子集的表示方法


数组表示法



直接用数组表示集合，这种表示方式比较直接，c++中的任何容器类型都可以用来存储集合



01 bit串表示法（二进制表示法）



使用一个整数的二进制形式来表示集合，二进制数第i个bit位为0，则表示全集中的第i个元素不在子集中，二进制数第i个bit位为1，则表示在子集中；例如一个包含3个元素的集合{1,2,3}的所有子集，可以用&lt;8的整数来表示：

0 -&gt; 000 -&gt; {}
1 -&gt; 001 -&gt; {1}
2 -&gt; 010 -&gt; {2}
3 -&gt; 011 -&gt; {1,2}
4 -&gt; 100 -&gt; {3}
5 -&g ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/20231019/atcoder-edu-dp-task-j-sushi/" title="(Hard) AtCoder Educational DP Contest - J. Sushi">(Hard) AtCoder Educational DP Contest - J. Sushi</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-10-19T14:05:15.000Z" title="Created 2023-10-19 22:05:15">2023-10-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/">编程竞赛/Competitive Programming</a></span></div><div class="content">
原题链接：https://atcoder.jp/contests/dp/tasks/dp_j
J - Sushi
Time Limit: 2 sec / Memory Limit: 1024 MB
Problem Statement
There are N dishes, numbered 1,2,…,N1,2,…,N1,2,…,N. Initially, for each i(1≤i≤N)i(1≤i≤N)i(1≤i≤N), Dish iii has ai(1≤ai≤3)a_i(1≤a_i≤3)ai​(1≤ai​≤3) pieces of sushi on it.
Taro will perform the following operation repeatedly until all the pieces of sushi are eaten:

Roll a die that shows the numbers 1,2,…,N1,2,…,N1,2,…,N with equal probabilities, and let iii be the outcome. If there ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/redgrey.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">RedGrey</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/RedGrey1993"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">愿你我都有美好生活</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/20240324/cf463d12f/" title="(*2700) ICM Technex 2018 and Codeforces Round 463 (Div. 1 + Div. 2, combined) F. Escape Through Leaf">(*2700) ICM Technex 2018 and Codeforces Round 463 (Div. 1 + Div. 2, combined) F. Escape Through Leaf</a><time datetime="2024-03-24T05:57:38.000Z" title="Created 2024-03-24 13:57:38">2024-03-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/20240312/codeforces-round185-div1-b/" title="(*2400) Codeforces Round 185 (Div. 1) B. Cats Transport">(*2400) Codeforces Round 185 (Div. 1) B. Cats Transport</a><time datetime="2024-03-12T14:42:15.000Z" title="Created 2024-03-12 22:42:15">2024-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/20240226/codeforces-round660-div2-e/" title="(*2700) Codeforces Round 660 (Div. 2) E. Uncle Bogdan and Projections">(*2700) Codeforces Round 660 (Div. 2) E. Uncle Bogdan and Projections</a><time datetime="2024-02-26T13:26:49.000Z" title="Created 2024-02-26 21:26:49">2024-02-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/20240129/greatest-common-divisor/" title="最大公约数/扩展欧几里得算法">最大公约数/扩展欧几里得算法</a><time datetime="2024-01-29T14:35:14.000Z" title="Created 2024-01-29 22:35:14">2024-01-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/20231219/mod-inverse/" title="模逆元">模逆元</a><time datetime="2023-12-18T16:54:26.000Z" title="Created 2023-12-19 00:54:26">2023-12-19</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%A4%87%E5%BF%98/"><span class="card-category-list-name">备忘</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E5%AD%A6-Math/"><span class="card-category-list-name">数学/Math</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E7%AB%9E%E8%B5%9B-Competitive-Programming/"><span class="card-category-list-name">编程竞赛/Competitive Programming</span><span class="card-category-list-count">11</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/Hexo/" style="font-size: 1.1em; color: #999">Hexo</a> <a href="/tags/%E4%BD%8D%E6%8E%A9%E7%A0%81-Bitmask/" style="font-size: 1.3em; color: #99a1ac">位掩码/Bitmask</a> <a href="/tags/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E7%B3%BB%E6%95%B0-Binomial-Coefficients/" style="font-size: 1.1em; color: #999">二项式系数/Binomial Coefficients</a> <a href="/tags/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97-Longest-Common-Subsequence/" style="font-size: 1.1em; color: #999">最长公共子序列/Longest Common Subsequence</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-Dynamic-Programming/" style="font-size: 1.5em; color: #99a9bf">动态规划/Dynamic Programming</a> <a href="/tags/%E5%87%A0%E4%BD%95-Geometry/" style="font-size: 1.1em; color: #999">几何/Geometry</a> <a href="/tags/%E5%87%B8%E5%8C%85%E6%8A%80%E5%B7%A7-Convex-Hull-Trick/" style="font-size: 1.4em; color: #99a5b6">凸包技巧/Convex Hull Trick</a> <a href="/tags/%E6%95%B0%E8%AE%BA-Number-Theory/" style="font-size: 1.2em; color: #999da3">数论/Number Theory</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2-DFS/" style="font-size: 1.1em; color: #999">深度优先搜索/DFS</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97-Cyclic-Longest-Common-Subsequence/" style="font-size: 1.1em; color: #999">循环最长公共子序列/Cyclic Longest Common Subsequence</a> <a href="/tags/%E8%BE%97%E8%BD%AC%E7%9B%B8%E9%99%A4%E6%B3%95/" style="font-size: 1.1em; color: #999">辗转相除法</a> <a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6-Combinatorics/" style="font-size: 1.3em; color: #99a1ac">组合数学/Combinatorics</a> <a href="/tags/Derangements/" style="font-size: 1.1em; color: #999">Derangements</a> <a href="/tags/%E6%A0%91-Tree/" style="font-size: 1.2em; color: #999da3">树/Tree</a> <a href="/tags/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/" style="font-size: 1.1em; color: #999">扩展欧几里得算法</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">March 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">February 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">January 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">December 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">November 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">October 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">September 2023</span><span class="card-archive-list-count">4</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">15</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Last Update :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-03-28T13:41:09.056Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By RedGrey</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>